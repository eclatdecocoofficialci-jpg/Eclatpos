<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Produits | √âclat de Coco POS</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      background-color: #fff0f6;
    }

    nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #f8bbd0;
      padding: 15px 25px;
    }

    nav h2 {
      color: white;
      margin: 0;
    }

    .nav-buttons a {
      color: white;
      text-decoration: none;
      margin-left: 15px;
      font-weight: 500;
    }

    .nav-buttons a.active {
      text-decoration: underline;
    }

    .product-layout {
      display: flex;
      justify-content: space-between;
      padding: 30px;
      gap: 20px;
    }

    .add-product {
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
      flex: 1;
    }

    .add-product input {
      width: 100%;
      padding: 8px;
      margin-bottom: 12px;
      border: 2px solid #f8bbd0;
      border-radius: 10px;
      outline: none;
    }

    .add-product button {
      width: 100%;
      padding: 10px;
      background-color: #e91e63;
      color: white;
      border: none;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
    }

    .add-product button:hover {
      background-color: #d81b60;
    }

    .product-table {
      flex: 2;
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      text-align: left;
    }

    th, td {
      border-bottom: 1px solid #f8bbd0;
      padding: 10px;
    }

    tr:hover {
      background-color: #fff5f8;
    }

    td[contenteditable="true"] {
      background-color: #fff7fa;
      border-radius: 5px;
    }

    .edit-btn, .delete-btn {
      cursor: pointer;
      border: none;
      background: none;
      font-size: 18px;
    }
  </style>
</head>

<body>
  <!-- üíó Navigation -->
  <nav>
    <h2>√âclat de Coco POS</h2>
    <div class="nav-buttons">
      <a href="index.html">POS</a>
      <a href="dashboard.html">Dashboard</a>
      <a href="sales.html">Sales Invoices</a>
      <a href="products.html" class="active">Products</a>
      <a href="inventory.html">Inventory</a>
      <a href="expenses.html">Expenses</a>
      <a href="reports.html">Reports</a>
    </div>
  </nav>

  <!-- üíÖ Main Layout -->
  <div class="product-layout">
    
    <!-- üå∏ Left Form -->
    <div class="add-product">
      <h3>Ajouter un Produit</h3>

      <label>Nom du Produit</label>
      <input type="text" id="name" placeholder="Ex: Savon Rose Vanille">

      <label>Cat√©gorie</label>
      <input type="text" id="category" placeholder="Ex: Savons">

      <label>Quantit√©</label>
      <input type="number" id="quantity" placeholder="Ex: 10">

      <label>Prix (FCFA)</label>
      <input type="number" id="price" placeholder="Ex: 2500">

      <label>Co√ªt (FCFA)</label>
      <input type="number" id="cost" placeholder="Ex: 1500">

      <button onclick="addProduct()">‚ûï Ajouter Produit</button>
    </div>

    <!-- üßæ Right Table -->
    <div class="product-table">
      <h3>Liste des Produits</h3>
      <table id="product-table">
        <thead>
          <tr>
            <th>Code</th>
            <th>Nom</th>
            <th>Cat√©gorie</th>
            <th>Quantit√©</th>
            <th>Prix</th>
            <th>Co√ªt</th>
            <th>Barcode</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="product-table-body">
          <tr><td colspan="8">Aucun produit ajout√©</td></tr>
        </tbody>
      </table>
    </div>

  </div>

  <!-- üåº Script -->
  <script>
    let products = JSON.parse(localStorage.getItem('products')) || [];
    const tableBody = document.getElementById('product-table-body');

    // üßÅ Refresh Table
    function refreshTable() {
      tableBody.innerHTML = products.length
        ? ""
        : '<tr><td colspan="8">Aucun produit ajout√©</td></tr>';

      products.forEach((p, index) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${p.code}</td>
          <td contenteditable="true" onblur="updateField(${index}, 'name', this.innerText)">${p.name}</td>
          <td contenteditable="true" onblur="updateField(${index}, 'category', this.innerText)">${p.category}</td>
          <td contenteditable="true" onblur="updateField(${index}, 'quantity', this.innerText)">${p.quantity}</td>
          <td contenteditable="true" onblur="updateField(${index}, 'price', this.innerText)">${p.price}</td>
          <td contenteditable="true" onblur="updateField(${index}, 'cost', this.innerText)">${p.cost}</td>
          <td>${p.barcode}</td>
          <td>
            <button class="delete-btn" onclick="deleteProduct(${index})">üóëÔ∏è</button>
          </td>`;
        tableBody.appendChild(tr);
      });
    }

    // üßÅ Auto Code Generator
    function generateCode(category) {
      const prefix = category.substring(0, 2).toUpperCase();
      const filtered = products.filter(p => p.code.startsWith(prefix));
      const num = (filtered.length + 1).toString().padStart(3, '0');
      return prefix + num;
    }

    // üéüÔ∏è Auto Barcode
    function generateBarcode() {
      return Math.floor(100000000 + Math.random() * 900000000);
    }

    // ‚ûï Add Product
    function addProduct() {
      const name = document.getElementById('name').value.trim();
      const category = document.getElementById('category').value.trim();
      const quantity = parseInt(document.getElementById('quantity').value) || 0;
      const price = parseFloat(document.getElementById('price').value) || 0;
      const cost = parseFloat(document.getElementById('cost').value) || 0;

      if (!name || !category) {
        alert('Veuillez entrer le nom et la cat√©gorie.');
        return;
      }

      const code = generateCode(category);
      const barcode = generateBarcode();

      products.push({ code, name, category, quantity, price, cost, barcode });
      localStorage.setItem('products', JSON.stringify(products));

      document.querySelectorAll('.add-product input').forEach(i => i.value = '');
      refreshTable();
    }

    // ‚úèÔ∏è Update Field
    function updateField(index, field, value) {
      products[index][field] = isNaN(value) ? value.trim() : Number(value);
      localStorage.setItem('products', JSON.stringify(products));
      refreshTable();
    }

    // üóëÔ∏è Delete Product
    function deleteProduct(index) {
      if (confirm('Supprimer ce produit ?')) {
        products.splice(index, 1);
        localStorage.setItem('products', JSON.stringify(products));
        refreshTable();
      }
    }

    refreshTable();
  </script>
</body>
</html>
